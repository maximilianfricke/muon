# Task 3: Edge-of-Stability & Directional Curvature (A + B)

experiment:
  name: "task3_eos"
  seed: 42
  device: "auto"

dataset:
  name: "mnist"
  root: "./data"
  full_batch: true
  train_subset_size: 10000   # optional speedup for Hessian ops

model:
  type: "mlp"
  config:
    input_size: 784
    hidden_sizes: [128, 64]
    num_classes: 10
    dropout: 0.0

training:
  num_epochs: 200
  loss_fn: "cross_entropy"

eos_analysis:
  track_frequency: 1

hessian:
  max_iter: 50
  tol: 1e-6

curvature_analysis:
  enabled: true
  track_frequency: 1         # usually same as eos_analysis
  num_probe_vecs: 8          
  # probe_subset_size: 2048  # uncomment to speed up curvature
  compute_preconditioned: true  # logged, but true H_eff not yet implemented

logging:
  wandb:
    enabled: true
    project: "muon"

output:
  save_dir: "./results/task3"

optimizers:
  gd:
    type: "gd"
    config:
      lr: 0.01
      momentum: 0.0
      weight_decay: 0.0

  adamw:
    type: "adamw"
    config:
      lr: 0.001
      weight_decay: 0.01

  muon:
    type: "muon"
    config:
      lr: 0.005
      momentum: 0.95
      ns_depth: 5
      use_rms: false
      use_orthogonalization: true
      weight_decay: 0.0
      adamw_lr: 0.001
