# Task 2: Muon component ablation config
experiment:
  name: "task2_ablation"
  seed: 42
  device: "auto"

dataset:
  name: "mnist"
  root: "./data"
  full_batch: true
  train_subset_size: 10000   # optional: speeds curvature; remove for full MNIST

model:
  type: "mlp"
  config:
    input_size: 784
    hidden_sizes: [128, 64]
    num_classes: 10
    dropout: 0.0

training:
  num_epochs: 100
  loss_fn: "cross_entropy"

curvature:
  track: true
  frequency: 5
  max_iter: 50
  tol: 1e-6

logging:
  wandb:
    enabled: true
  save_dir: "./results/task2"
  save_frequency: 10

# Shared defaults for every Muon run
muon_base_config:
  lr: 0.02
  momentum: 0.95
  adamw_lr: 0.001

# Ablation definition
ablation:
  # Use preset variants (cleaner than full 2^k grid)
  variants: ["full", "no_ortho", "no_rms", "rms_only", "ortho_only", "none"]

  # Vary NS depth (0 disables orthogonalization anyway)
  ns_depth: [0, 1, 3, 5, 7]

  # Vary weight decay
  weight_decay: [0.0, 0.01]


metrics:
  track_loss: true
  track_accuracy: true
  track_lambda_max: true
  track_frequency: 1

output:
  save_dir: "./results/task2"
  save_frequency: 10
